!function(t){function o(t){const o=t.currentTarget.previousElementSibling.value;var a=!1;"MVP"===o&&(n(),a=!0),"A03"===o&&(r(),a=!0),"WOMBOCOMBO"===o&&(i(),a=!0),a?cart.total.virtualPromo>cart.total.promo?c(o):s("Better promo already applied"):e()}function n(){const t=cart.lines.reduce(function(t,o){return t.unitPrice<o.unitPrice?o:t},{unitPrice:0});t.virtualPromo=.15*t.unitPrice,a()}function r(){cart.lines.filter(function(t){return"a03"===t.articleId}).forEach(function(t){t.virtualPromo=t.unitPrice*t.quantity*.2});a()}function i(){cart.total.virtualPromo=.1*cart.total.amount}function a(){cart.total.virtualPromo=cart.lines.reduce(function(t,o){return t+=o.virtualPromo},0)}function e(){promoCode.value="",s("Not a valid code")}function c(t){cart.total.promo=cart.total.virtualPromo,cart.total.promoCode=t,cart.lines.forEach(function(t){t.promo=t.virtualPromo,t.virtualPromo=0}),L(),y(),w(),promoStatus.innerHTML="$"+cart.total.promo.toFixed(2)+" discount",promoStatus.classList.add("promo--show")}function s(t){promoMsg.innerHTML=t,promoMsg.classList.add("promo--show"),setTimeout(function(){promoMsg.classList.remove("promo--show")},5e3)}function l(){cart.total.promoCode&&(cart.total.promo=0,cart.total.virtualPromo=0,cart.total.promoCode="",cart.lines.forEach(function(t){t.promo=0,t.virtualPromo=0}),promoStatus.classList.remove("promo--show"),promoCode.value="",promoStatus.innerHTML="",s("ALL PROMOS CLEARED"))}function u(t){const o=t.target.classList.contains("button-plus"),n=t.target.classList.contains("fa-plus");if(o||n){const r=o?t.target.parentNode.parentNode:t.target.parentNode.parentNode.parentNode,i=r.id.slice(5);cart.lines.filter(function(t){return t.articleId===i}).forEach(function(t){t.quantity++}),g()}}function d(t){const o=t.target.classList.contains("button-minus"),n=t.target.classList.contains("fa-minus");if(o||n){const r=o?t.target.parentNode.parentNode:t.target.parentNode.parentNode.parentNode,i=r.id.slice(5);cart.lines.filter(function(t){return t.articleId===i}).forEach(function(t){t.quantity--}),cart.lines=cart.lines.filter(function(t){return t.quantity>0}),v(),g(),listingContainer.style.marginBottom=cartContainer.offsetHeight-5+"px"}}function m(t){const o=t.target.classList.contains("button-remove"),n=t.target.classList.contains("fa-times");if(o||n){const r=o?t.target.parentNode.parentNode:t.target.parentNode.parentNode.parentNode,i=r.id.slice(5);cart.lines=cart.lines.filter(function(t){return t.articleId!==i}),r.remove(),g(),listingContainer.style.marginBottom=cartContainer.offsetHeight-5+"px"}}function p(t){if(t.target.classList.contains("add-button")){const o=listing.articles.filter(function(o){return o.id===t.target.id})[0],n=cart.lines.filter(function(t){return t.articleId===o.id}).map(function(t){return t.quantity++,t.amount+=o.price,t});n.length?L():f(o),g(),cartContainer.classList.add("cart--show"),listingContainer.classList.add("listing-container--cart-show")}}function f(o){cart.lines.push({articleId:o.id,quantity:1,unitPrice:o.price,amount:o.price,promo:0,virtualPromo:0});const n=t.createElement("div");n.classList.add("cart-list__item"),n.id="line-"+o.id,n.innerHTML='<div class="cart-list__item__info"><div class="button button--sm button-quantity button-remove"><span class="fa fa-times" aria-hidden="true"></span></div><div class="cart-list__item__name">'+o.name+'</div><span class="line-price">$'+o.price+'</span></div><div class="cart-list__item__quantity"><div class="button button--sm button-quantity button-minus"><span class="fa fa-minus" aria-hidden="true"></span></div><input class="coves-form__input input-quantity" value="1"><div class="button button--sm button-quantity button-plus"><span class="fa fa-plus" aria-hidden="true"></span></div></div>',cartList.appendChild(n)}function v(){const o=t.querySelectorAll(".cart-list__item");[].forEach.call(o,function(t){const o=cart.lines.some(function(o){return o.articleId===t.id.slice(5)});o||t.remove()})}function g(){l(),L(),y(),w()}function L(){const o=t.querySelectorAll(".cart-list__item");cart.lines.forEach(function(t,n){t.amount=t.quantity*t.unitPrice-t.promo,t.virtualPromo=0,o[n].children[1].children[1].value=t.quantity,o[n].children[0].children[2].innerHTML="$"+t.amount.toFixed(2)})}function y(){cart.total.amount=cart.lines.reduce(function(t,o){return t+=o.quantity*o.unitPrice},0)-cart.total.promo}function w(){const t="$"+cart.total.amount.toFixed(2);cartTotal.innerHTML=t,cartTotalModal.innerHTML=t;const o=cart.lines.reduce(function(t,o){return t+=o.quantity},0);cartCount.innerHTML=o,cartCountModal.innerHTML=o,o||(cartContainer.classList.remove("cart--show"),cartModalToggle.checked=!1)}window.listingContainer=t.querySelector("#listing-container"),window.cartContainer=t.querySelector("#cart-container"),window.cartCount=t.querySelector("#item-counter"),window.cartCountModal=t.querySelector("#item-counter-modal"),window.cartList=t.querySelector("#cart-list"),window.cartTotal=t.querySelector("#cart-total"),window.cartTotalModal=t.querySelector("#cart-total-modal"),window.cartModalToggle=t.querySelector("#cart-modal-toggle"),window.promoButton=t.querySelector("#promo-button"),window.promoCode=t.querySelector("#promo-code"),window.promoMsg=t.querySelector("#promo-msg"),window.promoStatus=t.querySelector("#promo-status"),listingContainer.addEventListener("click",p),cartList.addEventListener("click",m),cartList.addEventListener("click",d),cartList.addEventListener("click",u),promoButton.addEventListener("click",o)}(document);